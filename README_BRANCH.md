# Ветка admin-panel: Разработка административной панели Spanish Estate

> **Примечание:** Глобальное описание проекта и его текущий статус находятся в файлах [README.md](./README.md) и [STATUS.md](./STATUS.md) в основной ветке.

## Цель рабочей ветки
Разработка полноценной административной панели с системой аутентификации администраторов для управления содержимым сайта. Панель должна предоставлять интерфейс для всех разделов сайта с возможностью последующей интеграции ИИ-помощника.

## Концепция административной панели

Административная панель разрабатывается на основе следующих принципов:
1. Простой, интуитивно понятный интерфейс
2. Безопасная система аутентификации и разграничения ролей
3. Модульная структура с чётким разделением разделов управления
4. Подготовленные точки расширения для будущей интеграции ИИ-автоматизации

## Стадии разработки

Разработка административной панели будет происходить в три основных этапа:

### Этап 1: Базовая структура и аутентификация
- Реализация системы аутентификации через Supabase Auth
- Разработка базового макета панели с боковым меню
- Создание защищенных маршрутов и middleware для проверки прав доступа

### Этап 2: Функциональные модули управления контентом
- Разработка модуля управления объектами недвижимости
- Создание интерфейса для управления секциями главной страницы
- Реализация модуля управления статьями и контентом
- Настройка модуля управления ИИ-консультантом

### Этап 3: Интеграция с API и оптимизация
- Создание серверных API-маршрутов для всех функций управления
- Оптимизация производительности панели администратора
- Внедрение уведомлений о действиях и журналирования

## Задачи для текущей ветки (Этап 1)

### 1. Система аутентификации
- [ ] Создание страницы входа для администраторов
- [ ] Интеграция с Supabase Auth
- [ ] Настройка middleware для защиты маршрутов
- [ ] Реализация проверки ролей пользователей
- [ ] Функционал сброса пароля и обновления профиля

### 2. Структура и базовая навигация
- [ ] Разработка основного макета (layout) панели администратора
- [ ] Создание бокового меню с разделами
- [ ] Реализация шапки с информацией о пользователе
- [ ] Настройка маршрутизации между разделами
- [ ] Добавление функции выхода из учетной записи

### 3. Модуль управления недвижимостью
- [ ] Страница со списком всех объектов недвижимости
- [ ] Интерфейс для создания нового объекта
- [ ] Форма редактирования существующих объектов
- [ ] Функционал загрузки и управления изображениями
- [ ] Возможность скрытия/публикации/удаления объектов

### 4. Безопасность и права доступа
- [ ] Настройка системы разграничения прав доступа
- [ ] Защита API-эндпоинтов
- [ ] Валидация входных данных
- [ ] Журналирование действий администраторов

## Техническая спецификация

### Технологии
- Next.js 13.4.19 (App Router)
- React 18.2.0
- TypeScript
- Tailwind CSS
- Supabase (БД и аутентификация)
- React Hook Form (для форм)
- Zod (для валидации)

### Структура административной панели

```
/admin
├── /dashboard                 # Сводная статистика и быстрые действия
├── /properties                # Управление объектами недвижимости
│   ├── /                      # Список всех объектов
│   ├── /create                # Создание нового объекта
│   └── /[id]/edit             # Редактирование объекта
├── /content                   # Управление контентом главной страницы
│   ├── /hero                  # Настройки баннера
│   ├── /features              # Настройки блока преимуществ
│   ├── /showcase              # Настройки отображаемых объектов
│   └── /footer                # Настройки футера
├── /articles                  # Управление статьями блога
├── /ai                        # Настройки ИИ-консультанта
├── /media                     # Медиа-библиотека
├── /settings                  # Общие настройки сайта
└── /users                     # Управление администраторами
```

### API для управления контентом

Базовая структура API для панели администратора:

```
/api/admin
├── /auth                      # Аутентификация
├── /properties                # Управление объектами недвижимости
├── /content                   # Управление контентом главной страницы
├── /articles                  # Управление статьями
├── /media                     # Управление медиафайлами
└── /settings                  # Управление настройками
```

## Детальный план реализации страницы входа

1. **Структура страницы входа**
   - Создание формы с полями для ввода email и пароля
   - Добавление валидации ввода
   - Реализация обработки ошибок аутентификации
   - Интеграция с API Supabase Auth

2. **Middleware для защиты маршрутов**
   - Создание middleware для проверки наличия сессии пользователя
   - Реализация перенаправления на страницу входа
   - Настройка проверки ролей пользователя

3. **Компоненты макета панели администратора**
   - Шапка с информацией о пользователе и кнопкой выхода
   - Боковое меню с навигацией
   - Основная область содержимого
   - Компонент для отображения уведомлений

## Техническая реализация

### Структура файлов (первый этап)
```
app/admin/
   layout.tsx                  # Общий макет админ-панели
   login/
      page.tsx                 # Страница входа
      form.tsx                 # Компонент формы аутентификации
   dashboard/
      page.tsx                 # Главная страница админ-панели
   components/                 # Компоненты для админ-панели
      sidebar.tsx              # Боковое меню
      header.tsx               # Шапка
      auth-status.tsx          # Компонент статуса аутентификации
      notification.tsx         # Компонент уведомлений
middleware.ts                  # Middleware для защиты маршрутов
lib/
   supabase/
      admin-auth.ts            # Функции для работы с аутентификацией
      admin-api.ts             # Базовые функции для работы с API
```

## Приоритеты разработки

### Приоритеты Этапа 1
1. Создание работающей системы аутентификации администраторов
2. Разработка базового макета с навигацией по разделам
3. Защита маршрутов от несанкционированного доступа
4. Создание базовой инфраструктуры для управления данными

### Приоритеты Этапа 2
1. Полноценный интерфейс управления объектами недвижимости (CRUD)
2. Возможность загрузки и управления изображениями объектов
3. Управление статусом публикации объектов
4. Базовые функции редактирования контента страниц

### Приоритеты Этапа 3
1. Расширенная функциональность для всех модулей управления
2. Улучшенный пользовательский интерфейс с анимациями и переходами
3. Расширенные функции валидации и предварительного просмотра
4. Оптимизация производительности всех операций

## Критерии готовности

1. Система аутентификации администраторов работает корректно
2. Все основные функциональные модули реализованы
3. API-эндпоинты защищены и правильно обрабатывают запросы
4. Пользовательский интерфейс легко понятен и не требует обучения
5. Изменения, сделанные через административную панель, корректно отображаются на сайте

## План слияния с основной веткой
После завершения всех задач и успешного тестирования, данная ветка будет объединена с основной веткой `main`. При слиянии будет произведена интеграция кода административной панели, не нарушая работоспособность публичной части сайта. 